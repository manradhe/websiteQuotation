<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Quotation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        .error { color: red; font-size: 12px; }
    </style>
</head>
<body>

    <h2>Website Design & Development Quotation</h2>

    <form id="quotationForm">
        <label for="clientName">Client Name:</label>
        <input type="text" id="clientName" required>
        <span class="error" id="nameError"></span>
        <br><br>

        <label for="mobileNumber">Mobile Number:</label>
        <input type="text" id="mobileNumber" required>
        <span class="error" id="mobileError"></span>
        <br><br>

        <label for="projectDesc">Project Description:</label>
        <textarea id="projectDesc" required></textarea>
        <br><br>

        <label for="designCost">Design Cost ($):</label>
        <input type="number" id="designCost" required>
        <br><br>

        <label for="devCost">Development Cost ($):</label>
        <input type="number" id="devCost" required>
        <br><br>

        <label for="hostingCost">Hosting Cost ($):</label>
        <input type="number" id="hostingCost" required>
        <br><br>

        <label for="maintenanceCost">Maintenance Cost ($):</label>
        <input type="number" id="maintenanceCost" required>
        <br><br>

        <button type="button" onclick="validateForm()">Generate PDF</button>
    </form>

    <script>
        function validateForm() {
            let isValid = true;

            // Get form values
            let name = document.getElementById("clientName").value.trim();
            let mobile = document.getElementById("mobileNumber").value.trim();
            let nameError = document.getElementById("nameError");
            let mobileError = document.getElementById("mobileError");

            // Clear previous errors
            nameError.textContent = "";
            mobileError.textContent = "";

            // Name Validation (Only letters and spaces)
            let nameRegex = /^[A-Za-z\s]+$/;
            if (!nameRegex.test(name) || name.length < 3) {
                nameError.textContent = "Enter a valid name (letters only, min 3 characters)";
                isValid = false;
            }

            // Mobile Number Validation (Only numbers, 10-15 digits)
            let mobileRegex = /^[0-9]{10,15}$/;
            if (!mobileRegex.test(mobile)) {
                mobileError.textContent = "Enter a valid mobile number (10-15 digits)";
                isValid = false;
            }

            // If valid, generate PDF
            if (isValid) {
                downloadPDF();
            }
        }

        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            let doc = new jsPDF();

            // Check if autoTable is available
            if (typeof doc.autoTable !== "function") {
                alert("Error: autoTable plugin is missing.");
                return;
            }

            // Get form data
            let clientName = document.getElementById("clientName").value;
            let mobileNumber = document.getElementById("mobileNumber").value;
            let projectDesc = document.getElementById("projectDesc").value;
            let designCost = parseFloat(document.getElementById("designCost").value) || 0;
            let devCost = parseFloat(document.getElementById("devCost").value) || 0;
            let hostingCost = parseFloat(document.getElementById("hostingCost").value) || 0;
            let maintenanceCost = parseFloat(document.getElementById("maintenanceCost").value) || 0;
            let totalCost = designCost + devCost + hostingCost + maintenanceCost;

            // Add Company Name
            doc.setFont("helvetica", "bold");
            doc.setFontSize(20);
            doc.text("Your Company Name", 60, 20);

            // Add Quotation Title
            doc.setFontSize(14);
            doc.text("Website Design & Development Quotation", 60, 35);

            // Client & Project Information
            doc.setFontSize(12);
            doc.text(`Client Name: ${clientName}`, 20, 50);
            doc.text(`Mobile Number: ${mobileNumber}`, 20, 60);
            doc.text(`Project Description: ${projectDesc}`, 20, 70);

            // Create Table with autoTable
            doc.autoTable({
                startY: 80,
                head: [['Description', 'Cost (USD)']], // Table Headers
                body: [
                    ['Design Cost', `$${designCost.toFixed(2)}`],
                    ['Development Cost', `$${devCost.toFixed(2)}`],
                    ['Hosting Cost', `$${hostingCost.toFixed(2)}`],
                    ['Maintenance Cost', `$${maintenanceCost.toFixed(2)}`],
                    [{ content: 'Total Cost', styles: { fontStyle: 'bold' } }, { content: `$${totalCost.toFixed(2)}`, styles: { fontStyle: 'bold' } }]
                ],
                theme: 'grid',
                styles: { fontSize: 12, cellPadding: 5 },
                headStyles: { fillColor: [41, 128, 185], textColor: [255, 255, 255] },
                bodyStyles: { textColor: [0, 0, 0] }
            });

            // Save PDF
            doc.save(clientName + " " +mobileNumber+ ".pdf");
        }
    </script>

</body>
</html>
